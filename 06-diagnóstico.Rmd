# Diagnóstico del modelo de regresión de efectos mixtos {#reg-diagnos}

El diagnóstico del modelo de regresión es un método que permite determinar si un modelo de regresión ajustado representa adecuadamente los datos. Dicho diagnóstico puede ser de dos tipos: mediante métodos gráficos o métodos puramente numéricos (pruebas de hipótesis). No obstante el diagnóstico gráfico permite al analista descubrir no solo cuándo el modelo ajustado presenta problemas, sino que también permite detectar cuál puede ser la causa del mismo, lo cual sería casi imposible a través de los métodos numéricos.

El objetivo de este capitulo consiste en introducir al lector los distintos métodos de diagnostico del modelo, los cuales permitiran identificar aquel modelo que represente sus datos con una mayor precisión.

## Los residuos

```{r Representación gráfica de los que es un residuo, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE, fig.showtext = TRUE, out.width = "100%"}

library(dplyr)
library(ggplot2)
library(showtext) # Link donde hay varias fuentes de ejemplo (https://github.com/yixuan/showtext)
font_add_google('Gochi Hand', 'gochi')
showtext_auto()

Residuos <- tibble::tribble(
  ~x, ~y, ~z,
  'A', 0.0, 0.25,
  'A', 0.25, 0.5,
  'A', 0.5, 0.75,
  'A', 0.75, 1.0,
  'A', 1.0, 1.25
) %>%
  ggplot2::ggplot(aes(x = y, y = z, group = x)) +
  geom_line(colour = 'gray64', size = 1.4, alpha = 0.7) +
  geom_point(colour = 'gray64', size = 2.8, alpha = 0.7) +
  geom_point(aes(x = 0.0, y = 0.4), colour = 'red', size = 2.8, alpha = 0.5) +
  geom_point(aes(x = 0.25, y = 0.28), colour = 'red', size = 2.8, alpha = 0.5) +
  geom_point(aes(x = 0.5, y = 1.0), colour = 'red', size = 2.8, alpha = 0.5) +
  geom_point(aes(x = 0.75, y = 0.9), colour = 'red', size = 2.8, alpha = 0.5) +
  geom_point(aes(x = 1.0, y = 1.1), colour = 'red', size = 2.8, alpha = 0.5) +
  annotate(geom = 'rect', xmin = 0.0, xmax = 0.0, ymin = 0.27, ymax = 0.38, colour = 'black', fill = 'black', alpha = 0.4, size = 0.8, linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 0.25, xmax = 0.25, ymin = 0.48, ymax = 0.30, colour = 'black', fill = 'black', alpha = 0.4, size = 0.8, linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 0.5, xmax = 0.5, ymin = 0.77, ymax = 0.97, colour = 'black', fill = 'black', alpha = 0.4, size = 0.8, linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 0.75, xmax = 0.75, ymin = 0.97, ymax = 0.93, colour = 'black', fill = 'black', alpha = 0.4, size = 0.8, linetype = 'dashed') +
  annotate(geom = 'rect', xmin = 1.0, xmax = 1.0, ymin = 1.23, ymax = 1.15, colour = 'black', fill = 'black', alpha = 0.4, size = 0.8, linetype = 'dashed') +
  geom_curve(x = 0.5, xend = 0.5, y = 0.58, yend = 0.72, arrow = arrow(length = unit(0.1, 'inch')), size = 0.5, color = 'black', curvature = -0.5) +
  annotate(geom = 'text', x = 0.6, y = 0.58, label = 'Valor predicho', family = 'gochi', size = 8.8, colour = 'black') +
  geom_curve(x = 0.5, xend = 0.5, y = 1.18, yend = 1.03, arrow = arrow(length = unit(0.1, 'inch')), size = 0.5, color = 'black', curvature = -0.5) +
  annotate(geom = 'text', x = 0.43, y = 1.18, label = 'Valor real', family = 'gochi', size = 8.8, colour = 'black') +
  geom_curve(x = 0.42, xend = 0.49, y = 0.88, yend = 0.88, arrow = arrow(length = unit(0.1, 'inch')), size = 0.5, color = 'black', curvature = -0.2) +
  annotate(geom = 'text', x = 0.37, y = 0.88, label = 'Residuo', family = 'gochi', size = 8.8, colour = 'black') +
  theme_bw() +
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank())
Residuos
```

```{r Tabla de tipos de residuos, echo = FALSE, eval = TRUE, message = FALSE, warning = FALSE}

library(kableExtra)


Tabla_1 <- tibble::tribble(
  ~x, ~y,
  '-', '-',
  '-', '-',
  '-', '-'
)
rownames(Tabla_1) <- c('Estandarizado', 'Estudentizado 1', 'Estudentizado 2')

kable(Tabla_1) %>%
  kable_styling(full_width = FALSE) %>%
  footnote(symbol = c('Nota; ', 'Nota. '))
```

## El método gráfico

