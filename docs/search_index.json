[
["reg-diagnos.html", "6 Diagnóstico del modelo de regresión de efectos mixtos 6.1 Los residuos 6.2 Iniciando con el diagnóstico: prueba de hipótesis e inferencia visual", " 6 Diagnóstico del modelo de regresión de efectos mixtos El diagnóstico del modelo de regresión es un método que permite determinar si un modelo de regresión ajustado representa adecuadamente los datos. El objetivo de este capitulo consiste en introducir al lector los distintos métodos de diagnostico del modelo, los cuales permitiran identificar aquel modelo que represente sus datos con una mayor precisión. 6.1 Los residuos Los residuos son la base de la mayoría de los métodos de diagnóstico. Estos pueden ser de distinto tipo. Los residuos más básicos son los denominados residuos ordinarios, \\(\\hat{\\epsilon}_{i}\\), el cual se define como la diferencia entre el valor observado, \\(y_{i}\\), y su correspondiente valor estimado por el modelo, \\(\\hat{\\mu}_{i}\\), así: \\[\\begin{align*} \\hat{\\epsilon}_{i} = y_{i} - \\hat{\\mu}_{i}, i = 1, 2, ..., n \\end{align*}\\] donde \\(\\hat{\\mu}_{i}\\) es igual a \\(x^{&#39;}_{i}\\hat{\\beta}\\). A continuación, se presenta una representación gráfica de \\(\\hat{\\epsilon}_{i}\\): Figure 6.1: Representación gráfica de los residuos, del valor estimado y del valor observado. Luego los residuos ordinarios se escalan con el fin de que su interpretación no dependa de las unidades de medida de la variable dependiente. El proceso de estandarización consiste en dividir el residuo ordinario, \\(\\hat{\\epsilon}_{i}\\), por la expresión \\(\\sigma\\sqrt{(1-h_{i})}\\), donde \\({\\sigma}\\) corresponde a la desviación estandar verdadera y \\(h_{i}\\) al apalancamiento o valor de sombrero. Los residuos obtenidos de esta manera se denominan como residuos estandarizados. Sin embargo la verdadera desviación estándar rara vez se conoce. Por lo tanto, el escalado se puede realizar utilizando un estimador del mismo, es decir \\(\\hat{\\sigma}\\). Los residuos obtenidos de esta manera se denominan como residuos estudentizados, los cuales a su vez se dividen en dos: los residuos internamente estudentizados y los residuos externamente estudentizados. La tabla a continuación, resume las formas básicas de los residuos escalados: Formula matemática Estandarizado \\(\\frac{\\hat\\epsilon_i}{\\sigma\\sqrt{(1-h_i)}}\\) Internamente estudentizado \\(\\frac{\\hat\\epsilon_i}{\\hat\\sigma\\sqrt{(1-h_i)}}\\) Externamente estudentizado \\(\\frac{\\hat\\epsilon_i}{\\hat\\sigma_{(-i)}\\sqrt{(1-h_i)}}\\) * En el residuo internamente estudentizado, \\(\\hat\\sigma\\) denota una estimación de \\(\\sigma\\) basada en todas las observaciones; † En el residuo externamente estudentizado, \\(\\hat\\sigma_{(-i)}\\) es una estimación obtenida luego de excluir la i-ésima observación de los cálculos. Se usara la base de datos hsb del paquete merTools para entender mejor de que tratan los residuos, así como también los métodos de diagnosticos que explicaremos más adelante en este capitulo. A continuación podra ver la base de datos a usar: Se puede entender bien la lógica de los que son los residuos ajustando un modelo de regresión simple. El diagnóstico del modelo de regresión aborda la adecuación de un modelo estadístico una vez se han ajustado los datos. De hecho, el ajuste de un modelo debe verse como un proceso iterativo en el que se ajusta el modelo, se evalúan sus residuos y se mejora. Así hasta llegar a un modelo óptimo. Suponga que se quiere poner en relación dos variables: la variable \\(x_{1}\\) que representa el nivel socio-económico de los alumnos (ses), y la variable \\(y\\), que es el rendimiento de los mismos alumnos en una prueba de matemáticas (mathach). Para facilitar este análisis (y los posteriores) se asumira que \\(x_{1}\\) es una variable continua que toma valores entre -4 y +4, donde valores cercanos a 0 indican nivel socio-económico medio, cercanos a +4 indican nivel socio-económico alto y cercanos a -4 indican nivel socio-económico bajo. El modelo de regresión simple aplicado a este ejemplo se puede representar así: \\[\\begin{align} \\label{mod2} y_i &amp;\\sim N(\\mu_i, \\sigma^2), \\\\ \\mu_i &amp;= \\beta_0 + \\beta_1 x_{1i}, \\\\ \\sigma^2 &amp;= \\text{constante} \\end{align}\\] El codigó en R para ajustar el anterior modelo se presenta a continuación: Modelo_simple &lt;- lm(mathach ~ ses, data = hsb) #summary(Modelo_simple) Luego, los residuos (en este caso los residuos ordinarios) se pueden obtener con las siguientes funciones genericas: muestra_aleatoria$val_predicho &lt;- predict(Modelo_simple) muestra_aleatoria$res_ordinario &lt;- residuals(Modelo_simple) La gráfica a continuación presenta los valores observados y estimados en el rendimiento de los alumnos en una prueba de matemáticas según su nivel socio-económico, siendo la misma una representación gráfica similar a la presentada en la Figura 6.1: Tenga en cuenta que se bien el modelo se ajusto con las 7185 valores observados, la gráfica a continuación solo presenta 150 valores. Esto debido a que al no restringir por este valor, la gráfica se presentaba muy saturada de valores observados y estimados. Figure 6.2: Valores obserados y estimados en el rendimiento en una prueba matemática según el nivel socio-económico del estudiante. La gráfica anterior representa la relación existente entre el rendimiento académico y el nivel socio-económico del alumno. Claramente se puede observar que a mayor nivel socio-económico, mejor es el rendimiento del alumno. Una vez ajustado el modelo de regresión, y como se puede observar en la anterior gráfica, se tienen los valores observados (puntos con relleno), los valores estimados (puntos sin relleno) y el residuo (representado por una línea vertical que une a los valores observados con los estimados). Por tanto, puede imaginar ahora que cada dato (valor observado) tiene un valor estimado y un residuo (residuo ordinario en este caso) como se detalla a continuación: Rendimiento real Rendimiento estimado Residuo ordinario 19.268 13.991288 5.2767122 16.590 9.231414 7.3585861 15.017 11.172941 3.8440586 5.891 5.818083 0.0729167 Luego dichos residuos se consideran como elementos clave en la evaluación del modelo ajustado. Estos suelen emplearse en los métodos de diagnosticos del modelo de regresión mediante pruebas de hipótesis acompañadas de inferencia visual (gráficos). Por ejemplo, la figura a continuación muestra una de las gráficas comunmente usadas en los métodos de diagnostico: Existe una gran variedad de gráficos (como la presentada anteriormente) lo que refleja el hecho de que ningún gráfico de diagnóstico es apropiado para todos los propósitos. Veremos la interpretación de la misma con más detalle a continuación. 6.2 Iniciando con el diagnóstico: prueba de hipótesis e inferencia visual Como es sabido, la inferencia estadística clásica consiste en formular inicialmente un juego de hipótesis (hipótesis nula y alternativa), y calcular posteriormente un estadístico de prueba del cual se deriva un valor p que permitira concluir en relación a las hipótesis planteadas. Este proceso tiene su análogo en inferencia visual. Suponga que el interés consiste en verificar alguna suposición sobre el modelo ajustado: por ejemplo, la homogeneidad de la varianza residual. Para ello se plantea como hipótesis nula el cumplimiento de dicha homogeneidad, mientras que la hipótesis alternativa abarca cualquier violación de este supuesto. Para la inferencia visual, el estadístico de prueba corresponde a una gráfica que muestra un aspecto del supuesto que se desea verifcar, y permite al observador distinguir entre escenarios bajo la hipótesis nula y la alternativa. No obstante los métodos gráficos permiten al analista descubrir no solo cuándo el modelo ajustado no cumple con el supuesto planteado, sino que también permite detectar cuál puede ser la causa del mismo, lo cual sería casi imposible a través de unicamente pruebas de hipótesis. "]
]
